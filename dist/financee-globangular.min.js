var globalApp=angular.module("globalApp",["angular-loading-bar","ngAnimate","ui.bootstrap"]);!function(){"use strict";globalApp.config(["cfpLoadingBarProvider",function(a){a.includeSpinner=!0}])}(),function(){"use strict";globalApp.directive("navMenu",function(a){return function(b,c,d){var e,f,g,h,i,j=c.find("a"),k=d.navMenu||"on",l={};for(a.$$html5||(e=/^#[^/]*/),i=0;i<j.length;i++)f=angular.element(j[i]),g=f.attr("href"),a.$$html5?l[g]=f:l[g.replace(e,"")]=f;b.$on("$routeChangeStart",function(){var b=l[a.path()];b&&(h&&h.removeClass(k),h=b,h.addClass(k))})}})}(),function(){"use strict";globalApp.directive("nestedMenu",["$compile",function(a){return{restrict:"E",replace:!0,scope:{menu:"="},template:'<ul><li ng-repeat="item in menu"><a href="{{item.url}}"><i class="{{item.icon]}}"></i> {{item.name}}</a><span ng-if="item.Children.length > 0"><nestedMenu menu="item.Children"></nestedMenu></span></li></ul>',compile:function(b){var c,d=b.contents().remove();return function(b,e){c||(c=a(d)),c(b,function(a){e.append(a)})}}}}])}(),function(){"use strict";globalApp.directive("ngReallyClick",["$modal",function(a){var b=function(a,b){a.ok=function(){b.close()},a.cancel=function(){b.dismiss("cancel")}};return{restrict:"A",scope:{ngReallyClick:"&",item:"="},link:function(c,d,e){d.bind("click",function(){var d=e.ngReallyMessage||"Você realmente deseja prosseguir ?",f='<div class="modal-body">'+d+"</div>";f+='<div class="modal-footer"><button class="btn btn-primary" ng-click="ok()">OK</button><button class="btn btn-warning" ng-click="cancel()">Cancel</button></div>';var g=a.open({template:f,controller:b});g.result.then(function(){c.ngReallyClick({item:c.item})},function(){})})}}}])}(),function(){"use strict";globalApp.factory("$cache",[function(){var a={};return{get:function(b){return this.has(b)?a[b]:""},save:function(b,c){a[b]=c},drop:function(b){this.has(b)&&a.splice(b,1)},has:function(b){return"undefined"!=typeof a[b]}}}])}(),function(){"use strict";globalApp.factory("$global",["$http","cfpLoadingBar",function(a,b){var c={},d=function(a){var b={};return a&&"[object Function]"===b.toString.call(a)},e=function(a){c[a]=!1,b.complete()},f=function(a,b){var c="undefined"!=typeof b?b:"0",d={erro:"Falha ao acessar serviço!",status:c};return d};return{request:function(g,h,i){"undefined"==typeof c[g]&&(c[g]=!1),!1!==d(h)&&c[g]!==!0&&(c[g]=!0,b.start(),angular.isDefined(i)?a.post(g,$.param(i),{headers:{"Content-Type":"application/x-www-form-urlencoded"}}).success(function(a){e(g),h(a)}).error(function(a,b){e(g),h(f(a,b))}):a.get(g).success(function(a){e(g),h(a)}).error(function(a,b){e(g),h(f(a,b))}))}}}])}(),function(){"use strict";globalApp.factory("$newtab",[function(){return{open:function(a,b,c,d){var e=document.createElement("form");if(e.action=a,e.method=c||"post",e.target=d||"_blank",b)for(var f in b){var g=document.createElement("textarea");g.name=f,g.value="object"==typeof b[f]?JSON.stringify(b[f]):b[f],e.appendChild(g)}e.style.display="none",document.body.appendChild(e),e.submit()}}}])}(),function(){"use strict";globalApp.filter("dateToISO",function(){return function(a){return null===a||"0000-00-00"===a||"0000-00-00 00:00:00"===a?"":a=new Date(a).toISOString()}})}(),globalApp.provider("$api",function(){this.services={},this.check={},this.inverseservice={},this.quene=[],this.cList=!1,this.restricted=!1,this.pecbk=null,this.getVariables="",this.registerServices=function(a){this.check={permissions:[]};for(var b in a)a[b].permission=!0,"undefined"!=typeof a[b].urltype&&"common"===a[b].urltype&&(this.check.permissions.push(a[b].url),this.inverseservice[a[b].url]=b);this.services=a},this.cacheList=function(a){this.cList=a},this.concatInUrl=function(a){this.getVariables=a},this.permissionLocation=function(a){this.pecbk=a},this.$get=["$cache","$global","$location",function(a,b,c){function d(a,b,d,e,f){if("undefined"==typeof a.services[d])return void console.log("undefined service");if("undefined"==typeof a.services[d].permission&&(a.services[d].permission=!0),a.services[d].permission===!1){var g=a.pecbk;return null!==g&&c.path("/"+g),message_erro("Você não tem permissão para acessar esta página")}return b(a,d,e,f)}function e(a,c,e,g,h){if(this.restricted===!0)return 0!==a.quene.length?d(a,c,e,g,h):void a.quene.push([c,e,g,h]);a.quene.push([c,e,g,h]),this.restricted=!0;var i=f("usuario/perfil/userpermissions&ajax=1");b.request(i,function(b){for(var c in b)if("undefined"!=typeof a.inverseservice[b[c]]){var e=a.inverseservice[b[c]];a.services[e].permission=!1}for(var f in a.quene){var g=a.quene[f][0];d(a,g,a.quene[f][1],a.quene[f][2],a.quene[f][3])}a.quene=[]},a.check)}function f(a){var b=window.location.protocol+"//"+window.location.host+"/";return"undefined"!=typeof a&&(b+=a),b}function g(a,b){return"undefined"!=typeof a.status?"1"===a.status||1===a.status?("undefined"!=typeof a.success?message_success(a.success,5e3):message_alert("Dados inseridos sem confirmação do servidor. Não é possível determinar se a operação foi concluída com sucesso!"),!0):("undefined"!=typeof a.erro?message_erro(a.erro,5e3):message_alert("Falha ao salvar dados no servidor. Não é possível determinar qual o tipo de falha que ocorreu!"),!1):b===!0?(message_erro("Falha ao receber resposta do servidor!"),!1):!0}function h(a,b){return"undefined"==typeof this.services[a]?(console.log("Service "+a+" doesn't exists!"),!1):this.services[a].type===b?!0:(console.log("Method "+b+" is incorrect for service "+a+". Use method "+this.services[a].type+"."),!1)}function i(b,c,d){return"function"!=typeof c?!0:a.has(b+"/"+d)?(c(a.get(b+"/"+d)),!0):!1}function j(c,d,g){e(this,function(c,d,e,g){if(g="string"!=typeof g?"":"/"+g,!1!==c.serviceExists(d,"get")&&!0!==c.executeCallback(d,e,g)){var h="cache"===c.services[d].urltype?getUrlFiles(c.services[d].url):f(c.services[d].url)+g+c.getVariables;b.request(h,function(b){e(b),a.save(d+"/"+g,b)})}},c,d,g)}function k(a,c,d){e(this,function(a,c,d,e){if(!1!==a.serviceExists(c,"set")&&"undefined"!=typeof d){var g=f(a.services[c].url)+a.getVariables;b.request(g,e,d)}},a,c,d)}function l(c,d,h){e(this,function(c,d,e,h){if(!1!==c.serviceExists(d,"list")){var i=c;if(i.cList){var j=d+"_"+h;if(a.has(j))return void e(a.get(j))}var k=f(c.services[d].url);"string"==typeof h&&(k+="/"+h),k+=c.getVariables,b.request(k,function(b){e(b),g(b,!1),i.cList&&a.save(j,b)})}},c,d,h)}function m(a,c,d){e(this,function(a,c,d,e){if("string"==typeof e&&!1!==a.serviceExists(c,"drop")){var g=f(a.services[c].url);g+="/"+e+a.getVariables,b.request(g,d)}},a,d,c)}function n(a,b,c){e(this,function(a,b){console.log(b)},a,c,b)}return{list:l,drop:m,save:k,get:j,execute:n,executeCallback:i,serviceExists:h,hat_callback:g,services:this.services,check:this.check,inverseservice:this.inverseservice,quene:this.quene,cList:this.cList,pecbk:this.pecbk,getVariables:this.getVariables}}]});